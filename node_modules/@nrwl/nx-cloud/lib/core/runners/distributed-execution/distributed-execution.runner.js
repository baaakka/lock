const a8_0x5e57=['axiosException','completedTasks','VERBOSE_LOGGING','join','startTask','lifeCycle','NO_COMPLETED_TASKS_TIMEOUT','endTask','../../../utilities/create-unchanged-value-timeout','error','strip-json-comments','parse','logCommand','__awaiter','E2EEncryption','SIGINT','projectGraph','start','splitTasksIntoStages','../../../utilities/metric-logger','./node_modules/.cache/nx','taskGraph','number\x20of\x20completed\x20tasks:\x20','configuration','../../error/print-run-group-error','./task-graph-creator','criticalErrorMessage','Error:','nxCloudDistributedTasksRunner','./split-task-graph-into-stages','assign','../../file-storage/file-storage','target','Retrieving\x20artifacts\x20from\x20','log','/nx.json','taskId','submitRunMetrics','Found\x20unknown\x20task:\x20','TaskGraphCreator','Distributed\x20Execution\x20Terminated','../../../utilities/serializer-overrides','executionStatus','DistributedExecutionApi','strictlyOrderedTargets','dependencies','message','next','SIGTERM','cacheDirectory','run','Extracting\x20artifacts','error:\x20','../../api/error-reporter.api','Main\x20job\x20was\x20terminated\x20via\x20SIGINT','Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22','build','terminalOutput','addVerticalSeparator','Waiting...','tasks','\x20seconds.','serializeOverrides','Main\x20job\x20was\x20terminated\x20via\x20SIGTERM','Status\x20update','executionStatus:\x20','hash','Waiter','length','FileStorage','push','Starting\x20distributed\x20command\x20execution','note','../../file-storage/e2e-encryption','exit','ErrorReporterApi','status','__esModule','url','../../../utilities/nx-imports','completeRunGroupWithError','write','then','runUrl','toString','defineProperty','createUnchangedValueTimeout','targetDependencies','copyFilesFromCache','commandStatus','readFileSync','Unable\x20to\x20complete\x20a\x20run.','values','done','createTaskGraph','value','project','reset','See\x20run\x20details\x20at\x20'];(function(_0x237591,_0x5e5749){const _0x4ed223=function(_0x198487){while(--_0x198487){_0x237591['push'](_0x237591['shift']());}};_0x4ed223(++_0x5e5749);}(a8_0x5e57,0xf9));const a8_0x4ed2=function(_0x237591,_0x5e5749){_0x237591=_0x237591-0x0;let _0x4ed223=a8_0x5e57[_0x237591];return _0x4ed223;};'use strict';var __awaiter=this&&this[a8_0x4ed2('0x3d')]||function(_0x297502,_0x32268d,_0x4e5c4b,_0x4b3c6a){function _0x1ab646(_0x442c76){return _0x442c76 instanceof _0x4e5c4b?_0x442c76:new _0x4e5c4b(function(_0x552549){_0x552549(_0x442c76);});}return new(_0x4e5c4b||(_0x4e5c4b=Promise))(function(_0x545dbe,_0x2d249b){function _0x1f013a(_0x1b3b0e){try{_0x2cca1a(_0x4b3c6a[a8_0x4ed2('0x5f')](_0x1b3b0e));}catch(_0x94c290){_0x2d249b(_0x94c290);}}function _0x3d2048(_0x5660d0){try{_0x2cca1a(_0x4b3c6a['throw'](_0x5660d0));}catch(_0x470705){_0x2d249b(_0x470705);}}function _0x2cca1a(_0x7da951){_0x7da951[a8_0x4ed2('0x2a')]?_0x545dbe(_0x7da951[a8_0x4ed2('0x2c')]):_0x1ab646(_0x7da951[a8_0x4ed2('0x2c')])[a8_0x4ed2('0x1f')](_0x1f013a,_0x3d2048);}_0x2cca1a((_0x4b3c6a=_0x4b3c6a['apply'](_0x297502,_0x32268d||[]))[a8_0x4ed2('0x5f')]());});};Object[a8_0x4ed2('0x22')](exports,a8_0x4ed2('0x1a'),{'value':!![]});exports[a8_0x4ed2('0x4c')]=void 0x0;const fs_1=require('fs');const stripJsonComments=require(a8_0x4ed2('0x3a'));const create_unchanged_value_timeout_1=require(a8_0x4ed2('0x38'));const environment_1=require('../../../utilities/environment');const metric_logger_1=require(a8_0x4ed2('0x43'));const serializer_overrides_1=require(a8_0x4ed2('0x59'));const waiter_1=require('../../../utilities/waiter');const error_reporter_api_1=require(a8_0x4ed2('0x2'));const print_run_group_error_1=require(a8_0x4ed2('0x48'));const e2e_encryption_1=require(a8_0x4ed2('0x16'));const file_storage_1=require(a8_0x4ed2('0x4f'));const distributed_execution_api_1=require('./distributed-execution.api');const split_task_graph_into_stages_1=require(a8_0x4ed2('0x4d'));const task_graph_creator_1=require(a8_0x4ed2('0x49'));const {output,workspaceRoot,getOutputs,Cache}=require(a8_0x4ed2('0x1c'));class NoopLifeCycle{['scheduleTask'](_0x472e94){}[a8_0x4ed2('0x34')](_0x4c0922){}[a8_0x4ed2('0x37')](_0x4983ee,_0x287604){}}function runDistributedExecution(_0x42e452,_0x5f242f,_0x168a49,_0xba81d2,_0x5a2f3a,_0xd55c0d,_0x3fb056){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x4fcfcb=yield _0x42e452[a8_0x4ed2('0x41')]((0x0,distributed_execution_api_1['createStartRequest'])(_0xd55c0d,(0x0,split_task_graph_into_stages_1[a8_0x4ed2('0x42')])(_0x3fb056),_0x5f242f));return yield processTasks(_0x42e452,_0xba81d2,_0x5a2f3a,_0x5f242f,_0x4fcfcb,Object[a8_0x4ed2('0x29')](_0x3fb056[a8_0x4ed2('0x9')]),_0x168a49);});}function processTasks(_0xc2c430,_0x100814,_0x23b86b,_0x163afc,_0x5d586b,_0x81601b,_0x1b6633){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x22c463={};const _0xc50002=(0x0,create_unchanged_value_timeout_1[a8_0x4ed2('0x23')])({'title':'No\x20new\x20completed\x20tasks\x20after\x20'+environment_1[a8_0x4ed2('0x36')]/0x3e8+a8_0x4ed2('0xa'),'timeout':environment_1[a8_0x4ed2('0x36')]});const _0x335b5e=new waiter_1[(a8_0x4ed2('0x10'))]();while(!![]){if(environment_1[a8_0x4ed2('0x32')]){output[a8_0x4ed2('0x15')]({'title':a8_0x4ed2('0x8')});}yield _0x335b5e['wait']();const _0x3245e8=yield _0xc2c430[a8_0x4ed2('0x19')](_0x5d586b);if(environment_1['VERBOSE_LOGGING']){output[a8_0x4ed2('0x15')]({'title':a8_0x4ed2('0xd'),'bodyLines':['executionId:\x20'+_0x5d586b,a8_0x4ed2('0xe')+_0x3245e8[a8_0x4ed2('0x5a')],a8_0x4ed2('0x46')+_0x3245e8['completedTasks'][a8_0x4ed2('0x11')],a8_0x4ed2('0x1')+_0x3245e8[a8_0x4ed2('0x4a')]]});}if(_0x3245e8[a8_0x4ed2('0x4a')]){output[a8_0x4ed2('0x39')]({'title':a8_0x4ed2('0x58'),'bodyLines':[a8_0x4ed2('0x4b'),_0x3245e8[a8_0x4ed2('0x4a')]]});process[a8_0x4ed2('0x17')](0x1);}_0xc50002(_0x3245e8[a8_0x4ed2('0x31')][a8_0x4ed2('0x11')]);for(const _0x50d572 of _0x3245e8['completedTasks']){if(_0x22c463[_0x50d572['taskId']])continue;yield processTask(_0x100814,_0x23b86b,_0x1b6633,_0x163afc,_0x81601b,_0x50d572);_0x335b5e[a8_0x4ed2('0x2e')]();_0x22c463[_0x50d572[a8_0x4ed2('0x54')]]=!![];}if(_0x3245e8[a8_0x4ed2('0x5a')]==='COMPLETED'){return{'commandStatus':_0x3245e8[a8_0x4ed2('0x26')],'runUrl':_0x3245e8[a8_0x4ed2('0x20')]};}}});}function processTask(_0x34c3cb,_0x47a1e7,_0x2b3618,_0x4cb9d3,_0x1176f8,_0x4fc6be){return __awaiter(this,void 0x0,void 0x0,function*(){if(environment_1[a8_0x4ed2('0x32')]){output[a8_0x4ed2('0x15')]({'title':'Processing\x20task\x20'+_0x4fc6be[a8_0x4ed2('0x54')]});}const _0x2f687a=_0x1176f8['find'](_0xd8aab0=>_0x4fc6be[a8_0x4ed2('0x54')]===_0xd8aab0['id']);if(!_0x2f687a){throw new Error(a8_0x4ed2('0x56')+_0x4fc6be[a8_0x4ed2('0x54')]);}if(environment_1[a8_0x4ed2('0x32')]){output[a8_0x4ed2('0x15')]({'title':a8_0x4ed2('0x51')+_0x4fc6be[a8_0x4ed2('0x1b')]});}yield _0x34c3cb['retrieve'](_0x4fc6be[a8_0x4ed2('0xf')],_0x4fc6be[a8_0x4ed2('0x1b')],_0x4cb9d3[a8_0x4ed2('0x61')]||a8_0x4ed2('0x44'));const _0x5d6cab=yield _0x47a1e7['get'](Object['assign'](Object[a8_0x4ed2('0x4e')]({},_0x2f687a),{'hash':_0x4fc6be[a8_0x4ed2('0xf')]}));const _0x115390=getOutputs(_0x2b3618[a8_0x4ed2('0x40')]['nodes'],_0x2f687a);if(environment_1[a8_0x4ed2('0x32')]){output[a8_0x4ed2('0x15')]({'title':a8_0x4ed2('0x0'),'bodyLines':_0x115390});}yield _0x47a1e7[a8_0x4ed2('0x25')](_0x4fc6be['hash'],_0x5d6cab,_0x115390);output[a8_0x4ed2('0x3c')](getCommand(_0x2f687a));process['stdout'][a8_0x4ed2('0x1e')](_0x5d6cab[a8_0x4ed2('0x6')]);output[a8_0x4ed2('0x7')]();});}function getCommand(_0x56889d){const _0x468903=_0x56889d['target'][a8_0x4ed2('0x47')]?':'+_0x56889d[a8_0x4ed2('0x50')][a8_0x4ed2('0x47')]:'';return['nx',a8_0x4ed2('0x62'),_0x56889d[a8_0x4ed2('0x50')][a8_0x4ed2('0x2d')]+':'+_0x56889d[a8_0x4ed2('0x50')][a8_0x4ed2('0x50')]+_0x468903,(0x0,serializer_overrides_1[a8_0x4ed2('0xb')])(_0x56889d)][a8_0x4ed2('0x33')]('\x20');}function attachSignalListenersToCompleteRunGroupOnError(_0x8060d9,_0x19d2ae){process['on'](a8_0x4ed2('0x3f'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x8060d9[a8_0x4ed2('0x1d')](_0x19d2ae,a8_0x4ed2('0x3'));process[a8_0x4ed2('0x17')](0x1);}));process['on'](a8_0x4ed2('0x60'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x8060d9[a8_0x4ed2('0x1d')](_0x19d2ae,a8_0x4ed2('0xc'));process['exit'](0x1);}));}const nxCloudDistributedTasksRunner=(_0x33aac0,_0x45ba22,_0x5a9563)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(environment_1['VERBOSE_LOGGING']){output[a8_0x4ed2('0x15')]({'title':a8_0x4ed2('0x14')});}_0x45ba22[a8_0x4ed2('0x35')]=new NoopLifeCycle();const _0x1b2ba9=(0x0,environment_1['getRunGroup'])();if(!_0x1b2ba9){(0x0,print_run_group_error_1['printRunGroupError'])();return process[a8_0x4ed2('0x17')](0x1);}const _0x4ce73f=new e2e_encryption_1[(a8_0x4ed2('0x3e'))](environment_1['ENCRYPTION_KEY']||_0x45ba22['encryptionKey']);const _0x4b7f4e=new error_reporter_api_1[(a8_0x4ed2('0x18'))](_0x45ba22);const _0x5774b5=new file_storage_1[(a8_0x4ed2('0x12'))](_0x4ce73f,_0x4b7f4e,!![],![]);const _0x1f75e5=new Cache(_0x45ba22);const _0x4f3a96=new distributed_execution_api_1[(a8_0x4ed2('0x5b'))](_0x45ba22);attachSignalListenersToCompleteRunGroupOnError(_0x4f3a96,_0x1b2ba9);try{const _0x566d4d=getTaskGraph(_0x5a9563,_0x33aac0,_0x45ba22);const _0xd8bfed=yield runDistributedExecution(_0x4f3a96,_0x45ba22,_0x5a9563,_0x5774b5,_0x1f75e5,_0x1b2ba9,_0x566d4d);if(_0xd8bfed['commandStatus']===0x0){output['success']({'title':'Successfully\x20completed\x20running\x20the\x20command.','bodyLines':['See\x20run\x20details\x20at\x20'+_0xd8bfed[a8_0x4ed2('0x20')]]});}else{output[a8_0x4ed2('0x39')]({'title':'Command\x20execution\x20failed.','bodyLines':[a8_0x4ed2('0x2f')+_0xd8bfed[a8_0x4ed2('0x20')]]});}yield(0x0,metric_logger_1[a8_0x4ed2('0x55')])(_0x45ba22);process[a8_0x4ed2('0x17')](_0xd8bfed[a8_0x4ed2('0x26')]);}catch(_0x1bb31e){output['error']({'title':a8_0x4ed2('0x28'),'bodyLines':[_0x1bb31e['message']]});if(_0x1bb31e[a8_0x4ed2('0x30')]){console[a8_0x4ed2('0x52')](_0x1bb31e['axiosException']);}else{console[a8_0x4ed2('0x52')](_0x1bb31e);}try{yield _0x4f3a96[a8_0x4ed2('0x1d')](_0x1b2ba9,a8_0x4ed2('0x4')+_0x1bb31e[a8_0x4ed2('0x5e')]+'\x22');}finally{process[a8_0x4ed2('0x17')](0x1);}}});exports['nxCloudDistributedTasksRunner']=nxCloudDistributedTasksRunner;function getTaskGraph(_0x5339a2,_0x30b998,_0x170db1){if(_0x5339a2[a8_0x4ed2('0x45')]){return _0x5339a2[a8_0x4ed2('0x45')];}else{const _0x57fdb1=JSON[a8_0x4ed2('0x3b')](stripJsonComments((0x0,fs_1[a8_0x4ed2('0x27')])(workspaceRoot+a8_0x4ed2('0x53'))[a8_0x4ed2('0x21')]()));return new task_graph_creator_1[(a8_0x4ed2('0x57'))](_0x5339a2['projectGraph'],getDefaultDependencyConfigs(_0x57fdb1,_0x170db1))[a8_0x4ed2('0x2b')](_0x30b998);}}function getDefaultDependencyConfigs(_0x1cd7d6,_0x5ec2a2){var _0x26d7bb,_0x41da28;const _0x2d339f=(_0x26d7bb=_0x1cd7d6[a8_0x4ed2('0x24')])!==null&&_0x26d7bb!==void 0x0?_0x26d7bb:{};const _0x28eac2=_0x5ec2a2?(_0x41da28=_0x5ec2a2[a8_0x4ed2('0x5c')])!==null&&_0x41da28!==void 0x0?_0x41da28:[a8_0x4ed2('0x5')]:[];for(const _0xe321a6 of _0x28eac2){_0x2d339f[_0xe321a6]=_0x2d339f[_0xe321a6]||[];_0x2d339f[_0xe321a6][a8_0x4ed2('0x13')]({'target':_0xe321a6,'projects':a8_0x4ed2('0x5d')});}return _0x2d339f;}